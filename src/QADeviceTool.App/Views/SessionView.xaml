<UserControl x:Class="QADeviceTool.Views.SessionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Margin="24,16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- ═══════ LEFT: Session List ═══════ -->
        <Border Grid.Column="0" Style="{StaticResource GlassCard}" Margin="0,0,8,0">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="Sessions" Style="{StaticResource TextHeading2}" Margin="0,0,0,12" />

                <!-- New session controls -->
                <Border DockPanel.Dock="Top" Background="{StaticResource BrushBackgroundMedium}"
                        CornerRadius="8" Padding="12" Margin="0,0,0,12">
                    <StackPanel>
                        <!-- Device selector (shows connected devices) -->
                        <TextBlock Text="Select Device" 
                                   Foreground="{StaticResource BrushTextSecondary}"
                                   FontSize="11" Margin="0,0,0,4" />
                        <ComboBox ItemsSource="{Binding AvailableDevices}"
                                  SelectedItem="{Binding SelectedDevice}"
                                  DisplayMemberPath="DisplayName"
                                  Margin="0,0,0,8"
                                  Background="{StaticResource BrushBackgroundDarkest}"
                                  Foreground="{StaticResource BrushTextPrimary}"
                                  BorderBrush="{StaticResource BrushBorder}" />

                        <!-- Optional custom name -->
                        <TextBlock Text="Session name (optional)" 
                                   Foreground="{StaticResource BrushTextSecondary}"
                                   FontSize="11" Margin="0,0,0,4" />
                        <TextBox Style="{StaticResource DarkTextBox}"
                                 Text="{Binding NewSessionName, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0,0,0,8" />

                        <Button Style="{StaticResource PrimaryButton}" Content="+ New Session"
                                Command="{Binding CreateSessionCommand}" Margin="0,0,0,8" />

                        <!-- Auto-capture toggle -->
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <CheckBox IsChecked="{Binding AutoCapture}" VerticalAlignment="Center" Margin="0,0,8,0" />
                            <TextBlock Text="Auto-capture on connect" 
                                       Foreground="{StaticResource BrushTextSecondary}" 
                                       FontSize="12" VerticalAlignment="Center" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Session list -->
                <ListBox ItemsSource="{Binding Sessions}"
                         SelectedItem="{Binding SelectedSession}"
                         Style="{StaticResource DarkListBox}"
                         ScrollViewer.VerticalScrollBarVisibility="Auto">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem" BasedOn="{StaticResource DarkListBoxItem}" />
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Foreground="{StaticResource BrushTextPrimary}"
                                           FontSize="13" FontWeight="SemiBold"
                                           Text="{Binding Name}" />
                                <TextBlock Foreground="{StaticResource BrushTextSecondary}" FontSize="11"
                                           Text="{Binding DurationText}" Margin="0,2,0,0" />
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>
        </Border>

        <!-- ═══════ RIGHT: Log Viewer ═══════ -->
        <Border Grid.Column="1" Style="{StaticResource GlassCard}" Margin="8,0,0,0">
            <DockPanel>
                <!-- Header with actions -->
                <StackPanel DockPanel.Dock="Top" Margin="0,0,0,8">
                    <TextBlock Text="Live Log" Style="{StaticResource TextHeading2}" Margin="0,0,0,12" />
                    
                    <WrapPanel Margin="0,0,0,0">
                        <Button Style="{StaticResource PrimaryButton}" Content="Start"
                                Command="{Binding StartCaptureCommand}"
                                Padding="14,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Stop"
                                Command="{Binding StopCaptureCommand}"
                                Padding="14,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Save"
                                Command="{Binding SaveLogCommand}"
                                Padding="14,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Snap"
                                Command="{Binding TakeSnapshotCommand}"
                                Padding="14,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Open"
                                Command="{Binding OpenSessionFolderCommand}"
                                Padding="12,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Clear"
                                Command="{Binding ClearLogCommand}"
                                Padding="12,8" FontSize="12" Margin="0,0,8,8" />
                        <Button Style="{StaticResource SecondaryButton}" Content="Delete"
                                Command="{Binding DeleteSessionCommand}"
                                Padding="12,8" FontSize="12" Margin="0,0,0,8" />
                    </WrapPanel>
                </StackPanel>

                <!-- Status message -->
                <TextBlock DockPanel.Dock="Top" Text="{Binding StatusMessage}" 
                           Foreground="{StaticResource BrushAccent}"
                           FontSize="12" Margin="0,0,0,6" />

                <!-- Log viewer: TextBox with NO data binding — populated via AppendText from code-behind -->
                <TextBox x:Name="LogTextBox"
                         IsReadOnly="True"
                         TextWrapping="NoWrap"
                         VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto"
                         Background="{StaticResource BrushBackgroundDarkest}"
                         Foreground="{StaticResource BrushTextSecondary}"
                         FontFamily="{StaticResource FontMono}"
                         FontSize="12"
                         BorderBrush="{StaticResource BrushBorder}"
                         BorderThickness="1"
                         Padding="12"
                         AcceptsReturn="True"
                         UndoLimit="0" />
            </DockPanel>
        </Border>
    </Grid>
</UserControl>
